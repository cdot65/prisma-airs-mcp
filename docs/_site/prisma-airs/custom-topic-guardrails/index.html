<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Custom Topic Guardrails | Prisma AIRS MCP</title>
  <meta name="description" content="Define and enforce custom rules to block or allow topics based on your needs">
  
  <!-- SEO Tags -->
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Custom Topic Guardrails | Prisma AIRS MCP</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Custom Topic Guardrails" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Define and enforce custom rules to block or allow topics based on your needs" />
<meta property="og:description" content="Define and enforce custom rules to block or allow topics based on your needs" />
<link rel="canonical" href="http://localhost:4000/prisma-airs/custom-topic-guardrails/" />
<meta property="og:url" content="http://localhost:4000/prisma-airs/custom-topic-guardrails/" />
<meta property="og:site_name" content="Prisma AIRS MCP" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Custom Topic Guardrails" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Define and enforce custom rules to block or allow topics based on your needs","headline":"Custom Topic Guardrails","url":"http://localhost:4000/prisma-airs/custom-topic-guardrails/"}</script>
<!-- End Jekyll SEO tag -->

  
  <!-- Styles -->
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Rouge syntax highlighting is handled by Jekyll -->
  
  <!-- Favicons -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon-16x16.png">
</head>
<body>
  <nav class="navbar">
    <div class="container">
      <div class="navbar-brand">
        <a href="/" class="navbar-logo">
          <i class="fas fa-shield-alt"></i>
          Prisma AIRS MCP
        </a>
      </div>
      <div class="navbar-menu">
        <a href="/deployment" class="navbar-item ">Deployment</a>
        <a href="/developers" class="navbar-item ">Developers</a>
        <a href="/prisma-airs/overview" class="navbar-item active">Prisma AIRS</a>
        <a href="https://github.com/cdot65/prisma-airs-mcp" class="navbar-item">
          <i class="fab fa-github"></i>
        </a>
      </div>
    </div>
  </nav>

  <div class="documentation-layout">
    <aside class="sidebar">
      
<nav class="sidebar-nav">
  <h4>Getting Started</h4>
  <ul>
    <li><a href="/prisma-airs/overview/" >Overview</a></li>
  </ul>
  
  <h4>Threat Detection</h4>
  <ul>
    <li><a href="/prisma-airs/prompt-injection/" >Detect Prompt Injection</a></li>
    <li><a href="/prisma-airs/malicious-url/" >Detect Malicious URL</a></li>
    <li><a href="/prisma-airs/sensitive-data-loss/" >Detect Sensitive Data Loss</a></li>
    <li><a href="/prisma-airs/mask-sensitive-data/" >Mask Sensitive Data</a></li>
    <li><a href="/prisma-airs/database-security-attack/" >Detect Database Security Attack</a></li>
    <li><a href="/prisma-airs/toxic-content/" >Detect Toxic Content</a></li>
    <li><a href="/prisma-airs/malicious-code/" >Detect Malicious Code</a></li>
    <li><a href="/prisma-airs/ai-agent-threats/" >Detect AI Agent Threats</a></li>
    <li><a href="/prisma-airs/contextual-grounding/" >Detect Contextual Grounding</a></li>
    <li><a href="/prisma-airs/custom-topic-guardrails/" class="active">Custom Topic Guardrails</a></li>
    <li><a href="/prisma-airs/secure-mcp/" >Secure Model Context Protocol</a></li>
  </ul>
</nav>




<style>
.sidebar-nav {
  padding: var(--spacing-md);
}

.sidebar-nav h4 {
  font-size: 0.875rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--gray);
  margin-bottom: var(--spacing-sm);
  margin-top: var(--spacing-lg);
}

.sidebar-nav h4:first-child {
  margin-top: 0;
}

.sidebar-nav ul {
  list-style: none;
  padding: 0;
  margin: 0 0 var(--spacing-md) 0;
}

.sidebar-nav li {
  margin-bottom: var(--spacing-xs);
}

.sidebar-nav a {
  display: block;
  padding: var(--spacing-xs) var(--spacing-sm);
  color: var(--dark);
  border-radius: var(--border-radius);
  font-size: 0.9375rem;
  transition: all 0.2s ease;
}

.sidebar-nav a:hover {
  background-color: var(--gray-light);
  text-decoration: none;
}

.sidebar-nav a.active {
  background-color: var(--primary);
  color: var(--white);
  font-weight: 500;
}

.sidebar-nav a.active:hover {
  background-color: var(--primary-dark);
}
</style>
    </aside>
    
    <main class="documentation-content">
      <div class="content-header">
        <h1>Custom Topic Guardrails</h1>
        
        <p class="lead">Define and enforce custom rules to block or allow topics based on your needs</p>
        
      </div>
      
      <article class="content">
        <h2 id="overview">Overview</h2>

<p>Custom topic guardrails allow you to detect and block content that violates your configured topic policies. Enable Custom Topic Guardrails in your API security profile with Allow or Block actions.</p>

<h2 id="why-custom-guardrails">Why Custom Guardrails?</h2>

<p>Every organization has unique requirements:</p>

<ul>
  <li><strong>Industry Regulations</strong>: Sector-specific compliance</li>
  <li><strong>Company Policies</strong>: Internal guidelines and values</li>
  <li><strong>Brand Protection</strong>: Maintaining reputation</li>
  <li><strong>Legal Requirements</strong>: Jurisdiction-specific rules</li>
  <li><strong>Competitive Advantage</strong>: Protecting trade secrets</li>
  <li><strong>Cultural Sensitivity</strong>: Regional considerations</li>
</ul>

<h2 id="api-example">API Example</h2>

<h3 id="request-format">Request Format</h3>

<p>The following cURL request demonstrates using custom topic guardrails to detect policy violations:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-L</span> <span class="s1">'https://service.api.aisecurity.paloaltonetworks.com/v1/scan/sync/request'</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'x-pan-token: &lt;your-API-token&gt;'</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'Accept: application/json'</span> <span class="se">\</span>
<span class="nt">--data</span> <span class="s1">'{
  "tr_id": "1111",
  "ai_profile": {
    "profile_name": "custom-topic-guardrails-profile"
  },
  "metadata": {
    "app_user": "test-user-1",
    "ai_model": "Test AI model"
  },
    "contents": [
        {
            "prompt": "The exploration of Mars is driven by a multifaceted scientific curiosity. Primarily, scientists are interested in understanding Mars past habitability, searching for signs of past or present life, investigating the planet s geological evolution, and studying its climate and atmosphere. These studies can provide valuable insights into the formation and evolution of rocky planets in general, including our own Earth.  Furthermore, Mars offers a potential backup location for humanity should Earth become uninhabitable in the distant future. However, numerous technological hurdles impede human missions to Mars. These include the long duration of the journey 6-8 months each way, which exposes astronauts to prolonged radiation and the psychological effects of isolation. Developing reliable life support systems capable of functioning for years in a harsh environment poses a significant challenge. Landing heavy payloads safely on Mars is another obstacle, as is developing technologies for in-situ resource utilization ISRU to create propellant for the return trip, minimize mission mass, and build habitats. The potential health risks to astronauts from Martian dust, radiation, and low gravity also need further investigation and mitigation strategies",
           "response": "The exploration of Mars is driven by a multifaceted scientific curiosity. Primarily, scientists are interested in understanding Mars past habitability, searching for signs of past or present life, investigating the planet s geological evolution, and studying its climate and atmosphere. These studies can provide valuable insights into the formation and evolution of rocky planets in general, including our own Earth.  Furthermore, Mars offers a potential \"backup location\" for humanity should Earth become uninhabitable in the distant future.\n\nHowever, numerous technological hurdles impede human missions to Mars. These include the long duration of the journey (6-8 months each way), which exposes astronauts to prolonged radiation and the psychological effects of isolation. Developing reliable life support systems capable of functioning for years in a harsh environment poses a significant challenge. Landing heavy payloads safely on Mars is another obstacle, as is developing technologies for in-situ resource utilization (ISRU) to create propellant for the return trip, minimize mission mass, and build habitats. The potential health risks to astronauts from Martian dust, radiation, and low gravity also need further investigation and mitigation strategies."
        }
    ]
}'</span>
</code></pre></div></div>

<h3 id="response-format">Response Format</h3>

<p>When a topic violation is detected, the API returns:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"block"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"malicious"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"profile_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00000000-0000-0000-0000-000000000000"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"profile_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"custom-topic-guardrail"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"prompt_detected"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"topic_violation"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"prompt_detection_details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"topic_guardrails_details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"blocked_topics"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Astronomy and outer space exploration"</span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"report_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"R00000000-0000-0000-0000-000000000000"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_detected"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"topic_violation"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"response_detection_details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"topic_guardrails_details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"blocked_topics"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Astronomy and outer space exploration"</span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"scan_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00000000-0000-0000-0000-000000000000"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"tr_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1111"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>Key Response Fields</strong>:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">prompt_detected.topic_violation</code>: <code class="language-plaintext highlighter-rouge">true</code> indicates topic violation in prompt</li>
  <li><code class="language-plaintext highlighter-rouge">response_detected.topic_violation</code>: <code class="language-plaintext highlighter-rouge">true</code> indicates topic violation in response</li>
  <li><code class="language-plaintext highlighter-rouge">topic_guardrails_details.blocked_topics</code>: Array of violated blocked topics</li>
  <li><code class="language-plaintext highlighter-rouge">category</code>: Set to <code class="language-plaintext highlighter-rouge">"malicious"</code> when topic violations are found</li>
</ul>

<h3 id="detailed-report">Detailed Report</h3>

<p>The scan report provides additional details about the topic violation:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"detection_results"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"block"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"data_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"prompt"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"detection_service"</span><span class="p">:</span><span class="w"> </span><span class="s2">"topic_guardrails"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"result_detail"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"topic_guardrails_report"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"allowed_topic_list"</span><span class="p">:</span><span class="w"> </span><span class="s2">"not_matched"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"blockedTopics"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                            </span><span class="s2">"Astronomy and outer space exploration"</span><span class="w">
                        </span><span class="p">],</span><span class="w">
                        </span><span class="nl">"blocked_topic_list"</span><span class="p">:</span><span class="w"> </span><span class="s2">"matched"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="nl">"verdict"</span><span class="p">:</span><span class="w"> </span><span class="s2">"malicious"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"block"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"data_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"response"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"detection_service"</span><span class="p">:</span><span class="w"> </span><span class="s2">"topic_guardrails"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"result_detail"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"topic_guardrails_report"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"allowed_topic_list"</span><span class="p">:</span><span class="w"> </span><span class="s2">"not_matched"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"blockedTopics"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                            </span><span class="s2">"Astronomy and outer space exploration"</span><span class="w">
                        </span><span class="p">],</span><span class="w">
                        </span><span class="nl">"blocked_topic_list"</span><span class="p">:</span><span class="w"> </span><span class="s2">"matched"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="nl">"verdict"</span><span class="p">:</span><span class="w"> </span><span class="s2">"malicious"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"report_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"R00000000-0000-0000-0000-000000000000"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"req_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"scan_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00000000-0000-0000-0000-000000000000"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1111"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p><strong>Report Fields</strong>:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">allowed_topic_list</code>: Whether content matches allowed topics (“matched” or “not_matched”)</li>
  <li><code class="language-plaintext highlighter-rouge">blocked_topic_list</code>: Whether content matches blocked topics (“matched” or “not_matched”)</li>
  <li><code class="language-plaintext highlighter-rouge">blockedTopics</code>: List of specific blocked topics that were detected</li>
</ul>

<h2 id="configuration-types">Configuration Types</h2>

<h3 id="blocked-topics">Blocked Topics</h3>

<p>Topics that should be prevented in prompts and responses:</p>

<ul>
  <li>Competitor information</li>
  <li>Unreleased products</li>
  <li>Internal processes</li>
  <li>Sensitive company data</li>
</ul>

<h3 id="allowed-topics">Allowed Topics</h3>

<p>Topics that are explicitly permitted:</p>

<ul>
  <li>Public product information</li>
  <li>General customer support</li>
  <li>Educational content</li>
  <li>Published documentation</li>
</ul>

<h2 id="common-use-cases">Common Use Cases</h2>

<h3 id="enterprise-security">Enterprise Security</h3>

<ul>
  <li>Block discussion of competitor strategies</li>
  <li>Prevent leakage of confidential projects</li>
  <li>Restrict access to internal procedures</li>
  <li>Control financial information disclosure</li>
</ul>

<h3 id="industry-compliance">Industry Compliance</h3>

<ul>
  <li>Healthcare: Block medical advice</li>
  <li>Financial: Prevent investment recommendations</li>
  <li>Legal: Restrict legal counsel</li>
  <li>Education: Enforce age-appropriate content</li>
</ul>

<h3 id="brand-protection">Brand Protection</h3>

<ul>
  <li>Control messaging about products</li>
  <li>Prevent unauthorized announcements</li>
  <li>Maintain consistent communication</li>
  <li>Protect trade secrets</li>
</ul>

<h2 id="topic-detection">Topic Detection</h2>

<h3 id="how-it-works">How It Works</h3>

<ol>
  <li>Content is analyzed for topic matches</li>
  <li>Both allowed and blocked lists are checked</li>
  <li>Blocked topics take precedence</li>
  <li>Violations trigger configured actions</li>
</ol>

<h3 id="detection-precision">Detection Precision</h3>

<ul>
  <li>Semantic understanding of topics</li>
  <li>Context-aware matching</li>
  <li>Multi-language support</li>
  <li>Configurable sensitivity levels</li>
</ul>

<h2 id="performance-considerations">Performance Considerations</h2>

<ul>
  <li><strong>Real-time Scanning</strong>: Synchronous detection for immediate protection</li>
  <li><strong>Topic Matching</strong>: Fast semantic analysis</li>
  <li><strong>Dual Detection</strong>: Both prompts and responses analyzed</li>
  <li><strong>Scalable</strong>: Handles complex topic hierarchies</li>
</ul>

<h2 id="related-resources">Related Resources</h2>

<ul>
  <li><a href="/developers/api">API Reference</a></li>
  <li><a href="/prisma-airs/overview">Overview</a></li>
</ul>

      </article>
      
      <div class="content-footer">
        <div class="edit-page">
          <a href="https://github.com/cdot65/prisma-airs-mcp/edit/main/docs/_prisma-airs/custom-topic-guardrails.md">
            <i class="fas fa-edit"></i> Edit this page on GitHub
          </a>
        </div>
        
        
        <div class="pagination">
          
          
          <a href="/prisma-airs/database-security-attack/" class="next">
            Detect Database Security Attack <i class="fas fa-arrow-right"></i>
          </a>
          
        </div>
        
      </div>
    </main>
    
    <aside class="toc">
      <h4>On this page</h4>
      <nav id="table-of-contents"></nav>
    </aside>
  </div>

  <!-- Syntax highlighting is handled by Jekyll Rouge -->
  <script src="/assets/js/main.js"></script>
</body>
</html>