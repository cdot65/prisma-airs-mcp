<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Overview | Prisma AIRS MCP</title>
  <meta name="description" content="Developer documentation for Prisma AIRS MCP server">
  
  <!-- SEO Tags -->
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Overview | Prisma AIRS MCP</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Overview" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Developer documentation for Prisma AIRS MCP server" />
<meta property="og:description" content="Developer documentation for Prisma AIRS MCP server" />
<link rel="canonical" href="http://localhost:4000/developers/overview/" />
<meta property="og:url" content="http://localhost:4000/developers/overview/" />
<meta property="og:site_name" content="Prisma AIRS MCP" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Overview" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Developer documentation for Prisma AIRS MCP server","headline":"Overview","url":"http://localhost:4000/developers/overview/"}</script>
<!-- End Jekyll SEO tag -->

  
  <!-- Styles -->
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Rouge syntax highlighting is handled by Jekyll -->
  
  <!-- Favicons -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon-16x16.png">
</head>
<body>
  <nav class="navbar">
    <div class="container">
      <div class="navbar-brand">
        <a href="/" class="navbar-logo">
          <i class="fas fa-shield-alt"></i>
          Prisma AIRS MCP
        </a>
      </div>
      <div class="navbar-menu">
        <a href="/deployment" class="navbar-item ">Deployment</a>
        <a href="/developers" class="navbar-item active">Developers</a>
        <a href="/prisma-airs/overview" class="navbar-item ">Prisma AIRS</a>
        <a href="https://github.com/cdot65/prisma-airs-mcp" class="navbar-item">
          <i class="fab fa-github"></i>
        </a>
      </div>
    </div>
  </nav>

  <div class="documentation-layout">
    <aside class="sidebar">
      
<nav class="sidebar-nav">
  <h4>Getting Started</h4>
  <ul>
    <li><a href="/developers/overview/" class="active">Overview</a></li>
  </ul>
  
  <h4>Source Code Documentation</h4>
  <ul>
    <li><a href="/developers/src/" >Root (src/)</a></li>
    <li><a href="/developers/src/types/" >Types Module</a></li>
    <li><a href="/developers/src/airs/" >AIRS Module</a></li>
    <li><a href="/developers/src/config/" >Configuration</a></li>
    <li><a href="/developers/src/prompts/" >Prompts</a></li>
    <li><a href="/developers/src/resources/" >Resources</a></li>
    <li><a href="/developers/src/tools/" >Tools</a></li>
    <li><a href="/developers/src/transport/" >Transport</a></li>
    <li><a href="/developers/src/utils/" >Utilities</a></li>
  </ul>
  
  <h4>API</h4>
  <ul>
    <li><a href="/developers/api/" >API Reference</a></li>
  </ul>
  
  <h4>Release Notes</h4>
  <ul>
    <li><a href="/developers/release-notes/" >Version History</a></li>
  </ul>
</nav>



<style>
.sidebar-nav {
  padding: var(--spacing-md);
}

.sidebar-nav h4 {
  font-size: 0.875rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--gray);
  margin-bottom: var(--spacing-sm);
  margin-top: var(--spacing-lg);
}

.sidebar-nav h4:first-child {
  margin-top: 0;
}

.sidebar-nav ul {
  list-style: none;
  padding: 0;
  margin: 0 0 var(--spacing-md) 0;
}

.sidebar-nav li {
  margin-bottom: var(--spacing-xs);
}

.sidebar-nav a {
  display: block;
  padding: var(--spacing-xs) var(--spacing-sm);
  color: var(--dark);
  border-radius: var(--border-radius);
  font-size: 0.9375rem;
  transition: all 0.2s ease;
}

.sidebar-nav a:hover {
  background-color: var(--gray-light);
  text-decoration: none;
}

.sidebar-nav a.active {
  background-color: var(--primary);
  color: var(--white);
  font-weight: 500;
}

.sidebar-nav a.active:hover {
  background-color: var(--primary-dark);
}
</style>
    </aside>
    
    <main class="documentation-content">
      <div class="content-header">
        <h1>Overview</h1>
        
        <p class="lead">Developer documentation for Prisma AIRS MCP server</p>
        
      </div>
      
      <article class="content">
        <h2 id="introduction">Introduction</h2>

<p>The Prisma AIRS MCP server is a production-ready implementation of the Model Context Protocol that acts as an API bridge
between AI applications and Palo Alto Networks’ Prisma AIRS security platform. It exposes security scanning capabilities
through standard MCP tools, resources, and prompts.</p>

<h2 id="architecture-overview">Architecture Overview</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌─────────────────────────────────────────────────────────┐
│            MCP Client (Claude, VSCode, AI App)          │
└─────────────────────────┬───────────────────────────────┘
                          │ JSON-RPC 2.0 / SSE
┌─────────────────────────▼───────────────────────────────┐
│                 Express HTTP Server                     │
│                    (Port 3000)                          │
├─────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌──────────────┐  ┌──────────────┐    │
│  │  Resources  │  │    Tools     │  │   Prompts    │    │
│  │  Handler    │  │   Handler    │  │   Handler    │    │
│  └──────┬──────┘  └──────┬───────┘  └──────┬───────┘    │
│         │                │                 │            │
│  ┌──────▼────────────────▼─────────────────▼────────┐   │
│  │           HTTP Transport Handler                 │   │
│  │  • JSON-RPC routing  • SSE streaming support     │   │
│  │  • Session management • Error handling           │   │
│  └──────────────────────┬───────────────────────────┘   │
│                         │                               │
│  ┌──────────────────────▼───────────────────────────┐   │
│  │         Enhanced AIRS Client Module              │   │
│  │  • REST API Client   • Token Bucket Rate Limiter │   │
│  │  • LRU Cache         • Exponential Retry Logic   │   │
│  └──────────────────────┬───────────────────────────┘   │
└─────────────────────────┼───────────────────────────────┘
                          │ HTTPS (x-pan-token auth)
┌─────────────────────────▼───────────────────────────────┐
│                  Prisma AIRS API                        │
│                     (v1 endpoints)                      │
└─────────────────────────────────────────────────────────┘
</code></pre></div></div>

<h2 id="source-code-documentation">Source Code Documentation</h2>

<p>Our source code is organized into modular components, each serving a specific purpose in the MCP server architecture.
Here’s a high-level overview of each module:</p>

<h3 id="types-module-srctypes"><a href="/developers/src/types/">Types Module</a> (<code class="language-plaintext highlighter-rouge">src/types/</code>)</h3>

<p>The centralized type system providing TypeScript definitions for the entire application:</p>

<ul>
  <li><strong>Purpose</strong>: Single source of truth for all type definitions</li>
  <li><strong>Key Features</strong>:
    <ul>
      <li>Module-prefixed naming convention (Airs<em>, Mcp</em>, Config*, etc.)</li>
      <li>Prevents circular dependencies</li>
      <li>Enables type-safe development across all modules</li>
    </ul>
  </li>
  <li><strong>Components</strong>:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">airs.ts</code> - AIRS API types</li>
      <li><code class="language-plaintext highlighter-rouge">mcp.ts</code> - MCP protocol types</li>
      <li><code class="language-plaintext highlighter-rouge">config.ts</code> - Configuration types</li>
      <li><code class="language-plaintext highlighter-rouge">tools.ts</code> - Tool handler types</li>
      <li><code class="language-plaintext highlighter-rouge">transport.ts</code> - HTTP/SSE transport types</li>
    </ul>
  </li>
</ul>

<h3 id="airs-module-srcairs"><a href="/developers/src/airs/">AIRS Module</a> (<code class="language-plaintext highlighter-rouge">src/airs/</code>)</h3>

<p>The core integration layer with Prisma AIRS security API:</p>

<ul>
  <li><strong>Purpose</strong>: Provides robust, production-ready API client with enterprise features</li>
  <li><strong>Key Features</strong>:
    <ul>
      <li>REST API client with automatic retry logic</li>
      <li>LRU caching system for performance optimization</li>
      <li>Token bucket rate limiting to prevent API throttling</li>
      <li>Singleton factory pattern for consistent client instances</li>
    </ul>
  </li>
  <li><strong>Components</strong>:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">client.ts</code> - Base API client with error handling</li>
      <li><code class="language-plaintext highlighter-rouge">cache.ts</code> - In-memory LRU cache implementation</li>
      <li><code class="language-plaintext highlighter-rouge">rate-limiter.ts</code> - Token bucket rate limiting</li>
      <li><code class="language-plaintext highlighter-rouge">index.ts</code> - Enhanced client orchestrating all features</li>
      <li><code class="language-plaintext highlighter-rouge">factory.ts</code> - Singleton pattern implementation</li>
    </ul>
  </li>
</ul>

<h3 id="transport-module-srctransport"><a href="/developers/src/transport/">Transport Module</a> (<code class="language-plaintext highlighter-rouge">src/transport/</code>)</h3>

<p>Handles MCP protocol communication over HTTP and Server-Sent Events:</p>

<ul>
  <li><strong>Purpose</strong>: Implements the transport layer for MCP JSON-RPC 2.0 protocol</li>
  <li><strong>Key Features</strong>:
    <ul>
      <li>HTTP server for standard request/response</li>
      <li>SSE support for streaming operations</li>
      <li>Session management for persistent connections</li>
      <li>Request routing to appropriate handlers</li>
    </ul>
  </li>
  <li><strong>Components</strong>:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">http.ts</code> - Express-based HTTP transport</li>
      <li><code class="language-plaintext highlighter-rouge">sse.ts</code> - Server-Sent Events implementation</li>
    </ul>
  </li>
</ul>

<h3 id="tools-module-srctools"><a href="/developers/src/tools/">Tools Module</a> (<code class="language-plaintext highlighter-rouge">src/tools/</code>)</h3>

<p>Implements MCP tools for security scanning operations:</p>

<ul>
  <li><strong>Purpose</strong>: Exposes AIRS functionality as callable MCP tools</li>
  <li><strong>Available Tools</strong>:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">airs_scan_content</code> - Synchronous content scanning</li>
      <li><code class="language-plaintext highlighter-rouge">airs_scan_async</code> - Batch asynchronous scanning</li>
      <li><code class="language-plaintext highlighter-rouge">airs_get_scan_results</code> - Retrieve scan results</li>
      <li><code class="language-plaintext highlighter-rouge">airs_get_threat_reports</code> - Get detailed threat analysis</li>
      <li><code class="language-plaintext highlighter-rouge">airs_clear_cache</code> - Cache management</li>
    </ul>
  </li>
  <li><strong>Features</strong>:
    <ul>
      <li>JSON Schema validation for inputs</li>
      <li>Progress indicators for long operations</li>
      <li>Resource references in responses</li>
    </ul>
  </li>
</ul>

<h3 id="resources-module-srcresources"><a href="/developers/src/resources/">Resources Module</a> (<code class="language-plaintext highlighter-rouge">src/resources/</code>)</h3>

<p>Provides access to AIRS data through MCP resource URIs:</p>

<ul>
  <li><strong>Purpose</strong>: Implements MCP resource interface for data access</li>
  <li><strong>Resource Types</strong>:
    <ul>
      <li>Static: Cache stats, rate limit status</li>
      <li>Dynamic: Scan results, threat reports</li>
    </ul>
  </li>
  <li><strong>URI Scheme</strong>: <code class="language-plaintext highlighter-rouge">airs://{type}/{id}</code></li>
  <li><strong>Features</strong>:
    <ul>
      <li>RESTful resource access pattern</li>
      <li>JSON content type for all resources</li>
      <li>Automatic caching through AIRS client</li>
    </ul>
  </li>
</ul>

<h3 id="prompts-module-srcprompts"><a href="/developers/src/prompts/">Prompts Module</a> (<code class="language-plaintext highlighter-rouge">src/prompts/</code>)</h3>

<p>Pre-defined conversation workflows for common security tasks:</p>

<ul>
  <li><strong>Purpose</strong>: Provides structured security analysis workflows</li>
  <li><strong>Available Prompts</strong>:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">security_analysis</code> - Comprehensive threat analysis</li>
      <li><code class="language-plaintext highlighter-rouge">threat_investigation</code> - Deep dive into specific threats</li>
      <li><code class="language-plaintext highlighter-rouge">compliance_check</code> - Regulatory compliance verification</li>
      <li><code class="language-plaintext highlighter-rouge">incident_response</code> - Security incident handling guide</li>
    </ul>
  </li>
  <li><strong>Features</strong>:
    <ul>
      <li>Argument interpolation</li>
      <li>Step-by-step workflows</li>
      <li>Integration with tools and resources</li>
    </ul>
  </li>
</ul>

<h3 id="configuration-module-srcconfig"><a href="/developers/src/config/">Configuration Module</a> (<code class="language-plaintext highlighter-rouge">src/config/</code>)</h3>

<p>Centralized configuration management with runtime validation:</p>

<ul>
  <li><strong>Purpose</strong>: Type-safe configuration with environment variable support</li>
  <li><strong>Key Features</strong>:
    <ul>
      <li>Zod schema validation</li>
      <li>Singleton pattern for consistency</li>
      <li>Environment-based defaults</li>
      <li>Runtime type checking</li>
    </ul>
  </li>
  <li><strong>Configuration Areas</strong>:
    <ul>
      <li>Server settings (port, environment)</li>
      <li>AIRS API credentials and settings</li>
      <li>MCP protocol configuration</li>
    </ul>
  </li>
</ul>

<h3 id="utils-module-srcutils"><a href="/developers/src/utils/">Utils Module</a> (<code class="language-plaintext highlighter-rouge">src/utils/</code>)</h3>

<p>Shared utilities and cross-cutting concerns:</p>

<ul>
  <li><strong>Purpose</strong>: Common functionality used across modules</li>
  <li><strong>Components</strong>:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">logger.ts</code> - Winston-based structured logging</li>
    </ul>
  </li>
  <li><strong>Features</strong>:
    <ul>
      <li>Environment-aware log levels</li>
      <li>JSON formatting for production</li>
      <li>Request ID tracking</li>
    </ul>
  </li>
</ul>

<h3 id="root-module-srcindexts"><a href="/developers/src/">Root Module</a> (<code class="language-plaintext highlighter-rouge">src/index.ts</code>)</h3>

<p>The application entry point and Express server setup:</p>

<ul>
  <li><strong>Purpose</strong>: Initializes and orchestrates all components</li>
  <li><strong>Responsibilities</strong>:
    <ul>
      <li>Express server configuration</li>
      <li>Health and readiness endpoints</li>
      <li>MCP endpoint routing</li>
      <li>Graceful shutdown handling</li>
    </ul>
  </li>
  <li><strong>Endpoints</strong>:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">POST /</code> - Main MCP JSON-RPC endpoint</li>
      <li><code class="language-plaintext highlighter-rouge">GET /</code> - SSE streaming endpoint</li>
      <li><code class="language-plaintext highlighter-rouge">GET /health</code> - Health check</li>
      <li><code class="language-plaintext highlighter-rouge">GET /ready</code> - Readiness probe</li>
    </ul>
  </li>
</ul>

<h2 id="key-design-patterns">Key Design Patterns</h2>

<h3 id="1-centralized-type-system">1. Centralized Type System</h3>

<p>All TypeScript types are centralized in <code class="language-plaintext highlighter-rouge">src/types/</code> with consistent module prefixing to prevent naming conflicts and
circular dependencies.</p>

<h3 id="2-layered-architecture">2. Layered Architecture</h3>

<p>Clear separation of concerns with transport, business logic, and data access layers.</p>

<h3 id="3-singleton-pattern">3. Singleton Pattern</h3>

<p>Configuration and AIRS client use singleton pattern to ensure consistent state across the application.</p>

<h3 id="4-factory-pattern">4. Factory Pattern</h3>

<p>AIRS client factory manages instance creation and lifecycle.</p>

<h3 id="5-handler-pattern">5. Handler Pattern</h3>

<p>Separate handlers for tools, resources, and prompts implement the Strategy pattern for extensibility.</p>

<h2 id="performance--reliability-features">Performance &amp; Reliability Features</h2>

<h3 id="caching-system">Caching System</h3>

<ul>
  <li>LRU (Least Recently Used) eviction policy</li>
  <li>Configurable TTL (Time To Live)</li>
  <li>SHA-256 based cache key generation</li>
  <li>Automatic cache invalidation for incomplete results</li>
</ul>

<h3 id="rate-limiting">Rate Limiting</h3>

<ul>
  <li>Token bucket algorithm</li>
  <li>Per-operation rate limits</li>
  <li>Automatic request queuing</li>
  <li>Graceful degradation under load</li>
</ul>

<h3 id="error-handling">Error Handling</h3>

<ul>
  <li>Comprehensive error types for AIRS API and MCP protocol</li>
  <li>Automatic retry with exponential backoff</li>
  <li>Detailed error logging with context</li>
  <li>Client-friendly error messages</li>
</ul>

<h3 id="monitoring--observability">Monitoring &amp; Observability</h3>

<ul>
  <li>Health and readiness endpoints</li>
  <li>Structured JSON logging</li>
  <li>Performance metrics (cache hit rate, rate limit status)</li>
  <li>Request tracing with correlation IDs</li>
</ul>

<h2 id="security-considerations">Security Considerations</h2>

<ul>
  <li>API keys stored server-side only</li>
  <li>Input validation on all endpoints</li>
  <li>No execution of arbitrary code</li>
  <li>Secure handling of sensitive scan results</li>
  <li>Rate limiting to prevent abuse</li>
</ul>

<h2 id="next-steps">Next Steps</h2>

<ul>
  <li><a href="/developers/src/">Source Code Documentation</a> - Detailed documentation of each module</li>
  <li><a href="/developers/api/">API Reference</a> - Complete API documentation</li>
</ul>

      </article>
      
      <div class="content-footer">
        <div class="edit-page">
          <a href="https://github.com/cdot65/prisma-airs-mcp/edit/main/docs/_developers/overview.md">
            <i class="fas fa-edit"></i> Edit this page on GitHub
          </a>
        </div>
        
        
        <div class="pagination">
          
          
          <a href="/developers/release-notes/" class="next">
            Release Notes <i class="fas fa-arrow-right"></i>
          </a>
          
        </div>
        
      </div>
    </main>
    
    <aside class="toc">
      <h4>On this page</h4>
      <nav id="table-of-contents"></nav>
    </aside>
  </div>

  <!-- Syntax highlighting is handled by Jekyll Rouge -->
  <script src="/assets/js/main.js"></script>
</body>
</html>