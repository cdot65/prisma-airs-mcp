<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Overview | Prisma AIRS MCP</title>
  <meta name="description" content="Developer documentation for Prisma AIRS MCP server">
  
  <!-- SEO Tags -->
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Overview | Prisma AIRS MCP</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Overview" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Developer documentation for Prisma AIRS MCP server" />
<meta property="og:description" content="Developer documentation for Prisma AIRS MCP server" />
<link rel="canonical" href="http://localhost:4000/developers/overview/" />
<meta property="og:url" content="http://localhost:4000/developers/overview/" />
<meta property="og:site_name" content="Prisma AIRS MCP" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Overview" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Developer documentation for Prisma AIRS MCP server","headline":"Overview","url":"http://localhost:4000/developers/overview/"}</script>
<!-- End Jekyll SEO tag -->

  
  <!-- Styles -->
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Rouge syntax highlighting is handled by Jekyll -->
  
  <!-- Favicons -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon-16x16.png">
</head>
<body>
  <nav class="navbar">
    <div class="container">
      <div class="navbar-brand">
        <a href="/" class="navbar-logo">
          <i class="fas fa-shield-alt"></i>
          Prisma AIRS MCP
        </a>
      </div>
      <div class="navbar-menu">
        <a href="/deployment" class="navbar-item ">Deployment</a>
        <a href="/developers" class="navbar-item active">Developers</a>
        <a href="/prisma-airs/overview" class="navbar-item ">Prisma AIRS</a>
        <a href="https://github.com/cdot65/prisma-airs-mcp" class="navbar-item">
          <i class="fab fa-github"></i>
        </a>
      </div>
    </div>
  </nav>

  <div class="documentation-layout">
    <aside class="sidebar">
      
<nav class="sidebar-nav">
  <h4>Getting Started</h4>
  <ul>
    <li><a href="/developers/overview/" class="active">Overview</a></li>
  </ul>
  
  <h4>MCP Server Documentation</h4>
  <ul>
    <li><a href="/developers/client/" >AIRS Client Integration</a></li>
    <li><a href="/developers/resources/" >MCP Resources</a></li>
    <li><a href="/developers/tools/" >MCP Tools</a></li>
  </ul>
  
  <h4>API</h4>
  <ul>
    <li><a href="/developers/api/" >API Reference</a></li>
  </ul>
</nav>



<style>
.sidebar-nav {
  padding: var(--spacing-md);
}

.sidebar-nav h4 {
  font-size: 0.875rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--gray);
  margin-bottom: var(--spacing-sm);
  margin-top: var(--spacing-lg);
}

.sidebar-nav h4:first-child {
  margin-top: 0;
}

.sidebar-nav ul {
  list-style: none;
  padding: 0;
  margin: 0 0 var(--spacing-md) 0;
}

.sidebar-nav li {
  margin-bottom: var(--spacing-xs);
}

.sidebar-nav a {
  display: block;
  padding: var(--spacing-xs) var(--spacing-sm);
  color: var(--dark);
  border-radius: var(--border-radius);
  font-size: 0.9375rem;
  transition: all 0.2s ease;
}

.sidebar-nav a:hover {
  background-color: var(--gray-light);
  text-decoration: none;
}

.sidebar-nav a.active {
  background-color: var(--primary);
  color: var(--white);
  font-weight: 500;
}

.sidebar-nav a.active:hover {
  background-color: var(--primary-dark);
}
</style>
    </aside>
    
    <main class="documentation-content">
      <div class="content-header">
        <h1>Overview</h1>
        
        <p class="lead">Developer documentation for Prisma AIRS MCP server</p>
        
      </div>
      
      <article class="content">
        <h2 id="introduction">Introduction</h2>

<p>The Prisma AIRS MCP server is a production-ready implementation of the Model Context Protocol that acts as an API bridge between AI applications and Palo Alto Networks’ Prisma AIRS security platform. It exposes security scanning capabilities through standard MCP tools, resources, and prompts.</p>

<h2 id="architecture-overview">Architecture Overview</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌─────────────────────────────────────────────────────────┐
│                    MCP Client (Claude)                  │
└─────────────────────────┬───────────────────────────────┘
                          │ JSON-RPC 2.0
┌─────────────────────────▼───────────────────────────────┐
│                    MCP Server (HTTP)                    │
├─────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌──────────────┐  ┌──────────────┐    │
│  │  Resources  │  │    Tools     │  │   Prompts    │    │
│  └──────┬──────┘  └──────┬───────┘  └──────┬───────┘    │
│         │                │                  │           │
│  ┌──────▼────────────────▼──────────────────▼───────┐   │
│  │              MCP Server Implementation           │   │
│  └──────────────────────┬───────────────────────────┘   │
│                         │                               │
│  ┌──────────────────────▼───────────────────────────┐   │
│  │              AIRS Client Module                  │   │
│  │  • REST API Client   • Rate Limiter              │   │
│  │  • Response Cache    • Retry Logic               │   │
│  └──────────────────────┬───────────────────────────┘   │
└─────────────────────────┼───────────────────────────────┘
                          │ HTTPS
┌─────────────────────────▼───────────────────────────────┐
│                  Prisma AIRS API                        │
└─────────────────────────────────────────────────────────┘
</code></pre></div></div>

<h2 id="core-components">Core Components</h2>

<h3 id="1-mcp-server-implementation">1. MCP Server Implementation</h3>

<p>The server exposes Prisma AIRS security capabilities through the MCP protocol.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Server initialization with MCP capabilities</span>
<span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Server</span><span class="p">({</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">prisma-airs-mcp</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">version</span><span class="p">:</span> <span class="dl">'</span><span class="s1">1.0.0</span><span class="dl">'</span>
<span class="p">},</span> <span class="p">{</span>
  <span class="na">capabilities</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">resources</span><span class="p">:</span> <span class="p">{},</span>  <span class="c1">// Scan results, cache stats, rate limits</span>
    <span class="na">tools</span><span class="p">:</span> <span class="p">{},</span>      <span class="c1">// Security scanning operations</span>
    <span class="na">prompts</span><span class="p">:</span> <span class="p">{}</span>     <span class="c1">// Interactive security workflows</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="2-transport-layer">2. Transport Layer</h3>

<p>HTTP-based transport for Kubernetes deployment compatibility.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">transport</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HttpServerTransport</span><span class="p">({</span>
  <span class="na">port</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span>
  <span class="na">corsOptions</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">origin</span><span class="p">:</span> <span class="dl">'</span><span class="s1">*</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">methods</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">GET</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="k">await</span> <span class="nx">transport</span><span class="p">.</span><span class="nx">listen</span><span class="p">();</span>
</code></pre></div></div>

<h3 id="3-airs-client">3. AIRS Client</h3>

<p>Type-safe client for Prisma AIRS API integration.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">AIRSClientConfig</span> <span class="p">{</span>
  <span class="nl">apiUrl</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">apiKey</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">timeout</span><span class="p">?:</span> <span class="kr">number</span><span class="p">;</span>
  <span class="nl">maxRetries</span><span class="p">?:</span> <span class="kr">number</span><span class="p">;</span>
  <span class="nl">cache</span><span class="p">?:</span> <span class="nx">CacheConfig</span><span class="p">;</span>
  <span class="nl">rateLimit</span><span class="p">?:</span> <span class="nx">RateLimitConfig</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">PrismaAIRSClient</span> <span class="p">{</span>
  <span class="k">async</span> <span class="nx">scanContent</span><span class="p">(</span><span class="nx">request</span><span class="p">:</span> <span class="nx">ScanRequest</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ScanResponse</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="c1">// Implementation with retry logic and caching</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="4-resource-handlers">4. Resource Handlers</h3>

<p>MCP resources provide access to AIRS data.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">({</span>
  <span class="na">resources</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="na">uri</span><span class="p">:</span> <span class="dl">'</span><span class="s1">airs://cache-stats</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Cache Statistics</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">mimeType</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="na">uri</span><span class="p">:</span> <span class="dl">'</span><span class="s1">airs://rate-limit-status</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Rate Limit Status</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">mimeType</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}));</span>
</code></pre></div></div>

<h3 id="5-tool-handlers">5. Tool Handlers</h3>

<p>MCP tools execute AIRS operations.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">TOOLS</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">scan_content</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">description</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Scan content for security threats</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">inputSchema</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">properties</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">prompt</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">string</span><span class="dl">'</span> <span class="p">},</span>
        <span class="na">response</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">string</span><span class="dl">'</span> <span class="p">},</span>
        <span class="na">profile_name</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">string</span><span class="dl">'</span> <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">];</span>
</code></pre></div></div>

<h2 id="key-features">Key Features</h2>

<h3 id="type-safety">Type Safety</h3>

<p>All components use TypeScript with strict mode:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Strongly typed interfaces</span>
<span class="kr">interface</span> <span class="nx">ScanRequest</span> <span class="p">{</span>
  <span class="nl">tr_id</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">ai_profile</span><span class="p">:</span> <span class="nx">AiProfile</span><span class="p">;</span>
  <span class="nl">metadata</span><span class="p">?:</span> <span class="nx">Metadata</span><span class="p">;</span>
  <span class="nl">contents</span><span class="p">:</span> <span class="nx">ContentItem</span><span class="p">[];</span>
<span class="p">}</span>

<span class="c1">// Type guards for runtime validation</span>
<span class="kd">function</span> <span class="nx">isScanResponse</span><span class="p">(</span><span class="nx">data</span><span class="p">:</span> <span class="nx">unknown</span><span class="p">):</span> <span class="nx">data</span> <span class="k">is</span> <span class="nx">ScanResponse</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">typeof</span> <span class="nx">data</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> 
         <span class="nx">data</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> 
         <span class="dl">'</span><span class="s1">scan_id</span><span class="dl">'</span> <span class="k">in</span> <span class="nx">data</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="error-handling">Error Handling</h3>

<p>Comprehensive error handling with MCP error codes:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">enum</span> <span class="nx">MCPErrorCode</span> <span class="p">{</span>
  <span class="nx">ParseError</span> <span class="o">=</span> <span class="o">-</span><span class="mi">32700</span><span class="p">,</span>
  <span class="nx">InvalidRequest</span> <span class="o">=</span> <span class="o">-</span><span class="mi">32600</span><span class="p">,</span>
  <span class="nx">MethodNotFound</span> <span class="o">=</span> <span class="o">-</span><span class="mi">32601</span><span class="p">,</span>
  <span class="nx">InvalidParams</span> <span class="o">=</span> <span class="o">-</span><span class="mi">32602</span><span class="p">,</span>
  <span class="nx">InternalError</span> <span class="o">=</span> <span class="o">-</span><span class="mi">32603</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">MCPError</span> <span class="kd">extends</span> <span class="nb">Error</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="k">public</span> <span class="nx">code</span><span class="p">:</span> <span class="nx">MCPErrorCode</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
    <span class="k">public</span> <span class="nx">data</span><span class="p">?:</span> <span class="nx">unknown</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="caching-system">Caching System</h3>

<p>TTL-based in-memory cache for performance:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">AIRSCache</span> <span class="p">{</span>
  <span class="k">private</span> <span class="nx">cache</span><span class="p">:</span> <span class="nb">Map</span><span class="o">&lt;</span><span class="kr">string</span><span class="p">,</span> <span class="nx">CacheEntry</span><span class="o">&gt;</span><span class="p">;</span>
  
  <span class="kd">set</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span> <span class="nx">ttl</span><span class="p">?:</span> <span class="kr">number</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">expiry</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">ttl</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">defaultTTL</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="p">{</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">expiry</span> <span class="p">});</span>
  <span class="p">}</span>
  
  <span class="kd">get</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">any</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">entry</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">entry</span> <span class="o">||</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">expiry</span> <span class="o">&lt;</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="rate-limiting">Rate Limiting</h3>

<p>Token bucket algorithm for API protection:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">AIRSRateLimiter</span> <span class="p">{</span>
  <span class="k">private</span> <span class="nx">buckets</span><span class="p">:</span> <span class="nb">Map</span><span class="o">&lt;</span><span class="kr">string</span><span class="p">,</span> <span class="nx">TokenBucket</span><span class="o">&gt;</span><span class="p">;</span>
  
  <span class="k">async</span> <span class="nx">checkLimit</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">boolean</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">bucket</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getBucket</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">bucket</span><span class="p">.</span><span class="nx">consume</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="api-usage-patterns">API Usage Patterns</h2>

<h3 id="basic-mcp-request">Basic MCP Request</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Example MCP request to the server</span>
<span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">jsonrpc</span><span class="p">:</span> <span class="dl">"</span><span class="s2">2.0</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">tools/call</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">airs_scan_content</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">arguments</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">prompt</span><span class="p">:</span> <span class="dl">"</span><span class="s2">User input to scan</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">profileName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Prisma AIRS</span><span class="dl">"</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="na">id</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">};</span>

<span class="c1">// Send via HTTP POST to server endpoint</span>
<span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">http://localhost:3000</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span> <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span> <span class="p">},</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">request</span><span class="p">)</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="using-mcp-client-libraries">Using MCP Client Libraries</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// With any MCP-compatible client</span>
<span class="k">try</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">mcpClient</span><span class="p">.</span><span class="nx">callTool</span><span class="p">(</span><span class="dl">'</span><span class="s1">airs_scan_content</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">prompt</span><span class="p">:</span> <span class="nx">userInput</span><span class="p">,</span>
    <span class="na">response</span><span class="p">:</span> <span class="nx">aiResponse</span><span class="p">,</span>
    <span class="na">profileName</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Prisma AIRS</span><span class="dl">'</span>
  <span class="p">});</span>
  
  <span class="c1">// Check response content</span>
  <span class="kd">const</span> <span class="nx">scanResult</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">content</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">text</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">scanResult</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">malicious</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// Handle threat detection</span>
  <span class="p">}</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">code</span> <span class="o">===</span> <span class="o">-</span><span class="mi">32603</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Server error - check logs</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="resource-access">Resource Access</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// List available resources via MCP</span>
<span class="kd">const</span> <span class="nx">resources</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">mcpClient</span><span class="p">.</span><span class="nx">listResources</span><span class="p">();</span>

<span class="c1">// Read specific resource</span>
<span class="kd">const</span> <span class="nx">cacheStats</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">mcpClient</span><span class="p">.</span><span class="nx">readResource</span><span class="p">(</span><span class="dl">'</span><span class="s1">airs://cache-stats</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Cache statistics:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">cacheStats</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="server-extension-points">Server Extension Points</h2>

<h3 id="custom-tools">Custom Tools</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Define new tool</span>
<span class="kd">const</span> <span class="nx">customTool</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">custom_analysis</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">description</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Custom security analysis</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">inputSchema</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">properties</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">content</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">string</span><span class="dl">'</span> <span class="p">},</span>
      <span class="na">options</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span> <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="na">handler</span><span class="p">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Custom implementation</span>
    <span class="k">return</span> <span class="p">{</span> <span class="na">result</span><span class="p">:</span> <span class="dl">'</span><span class="s1">analysis</span><span class="dl">'</span> <span class="p">};</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// Register tool</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">addTool</span><span class="p">(</span><span class="nx">customTool</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="custom-resources">Custom Resources</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Add dynamic resource</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">addResourceProvider</span><span class="p">({</span>
  <span class="na">pattern</span><span class="p">:</span> <span class="sr">/^airs:</span><span class="se">\/\/</span><span class="sr">custom</span><span class="se">\/</span><span class="sr">.*/</span><span class="p">,</span>
  <span class="na">handler</span><span class="p">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">uri</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">uri</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">).</span><span class="nx">pop</span><span class="p">();</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">uri</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="s2">`Custom Resource </span><span class="p">${</span><span class="nx">id</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
      <span class="na">mimeType</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">text</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="nx">id</span><span class="p">,</span> <span class="na">data</span><span class="p">:</span> <span class="dl">'</span><span class="s1">custom</span><span class="dl">'</span> <span class="p">})</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<h2 id="performance-considerations">Performance Considerations</h2>

<h3 id="connection-pooling">Connection Pooling</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">httpAgent</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Agent</span><span class="p">({</span>
  <span class="na">keepAlive</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">maxSockets</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
  <span class="na">timeout</span><span class="p">:</span> <span class="mi">30000</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="request-batching">Request Batching</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Batch multiple scans</span>
<span class="kd">const</span> <span class="nx">results</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">callTool</span><span class="p">(</span><span class="dl">'</span><span class="s1">scan_async</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">contents</span><span class="p">:</span> <span class="nx">items</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span> <span class="o">=&gt;</span> <span class="p">({</span>
    <span class="na">prompt</span><span class="p">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">input</span><span class="p">,</span>
    <span class="na">response</span><span class="p">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">output</span>
  <span class="p">}))</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="caching-strategy">Caching Strategy</h3>

<ul>
  <li>Cache scan results for 5 minutes by default</li>
  <li>Automatic cache eviction on memory pressure</li>
  <li>Cache key based on content hash</li>
</ul>

<h2 id="best-practices">Best Practices</h2>

<ol>
  <li><strong>Error Handling</strong>: Always handle MCP error responses properly</li>
  <li><strong>Rate Limiting</strong>: Implement backoff strategies</li>
  <li><strong>Logging</strong>: Use structured logging for debugging</li>
  <li><strong>Monitoring</strong>: Track metrics for performance</li>
  <li><strong>Security</strong>: Never log sensitive content</li>
</ol>

<h2 id="next-steps">Next Steps</h2>

<ul>
  <li><a href="/developers/client">AIRS Integration</a> - How the server integrates with AIRS</li>
  <li><a href="/developers/resources">MCP Resources</a> - Available server resources</li>
  <li><a href="/developers/tools">MCP Tools</a> - Security scanning tools</li>
  <li><a href="/developers/prompts">MCP Prompts</a> - Interactive workflows</li>
</ul>

      </article>
      
      <div class="content-footer">
        <div class="edit-page">
          <a href="https://github.com/cdot65/prisma-airs-mcp/edit/main/docs/_developers/overview.md">
            <i class="fas fa-edit"></i> Edit this page on GitHub
          </a>
        </div>
        
        
        <div class="pagination">
          
          
          <a href="/developers/resources/" class="next">
            MCP Resources <i class="fas fa-arrow-right"></i>
          </a>
          
        </div>
        
      </div>
    </main>
    
    <aside class="toc">
      <h4>On this page</h4>
      <nav id="table-of-contents"></nav>
    </aside>
  </div>

  <!-- Syntax highlighting is handled by Jekyll Rouge -->
  <script src="/assets/js/main.js"></script>
</body>
</html>