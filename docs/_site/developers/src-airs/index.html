<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AIRS Module (src/airs/) | Prisma AIRS MCP</title>
  <meta name="description" content="AI Runtime Security through Model Context Protocol - Secure your AI applications with enterprise-grade threat detection">
  
  <!-- SEO Tags -->
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>AIRS Module (src/airs/) | Prisma AIRS MCP</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="AIRS Module (src/airs/)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="AIRS Module Documentation" />
<meta property="og:description" content="AIRS Module Documentation" />
<link rel="canonical" href="http://localhost:4000/developers/src-airs/" />
<meta property="og:url" content="http://localhost:4000/developers/src-airs/" />
<meta property="og:site_name" content="Prisma AIRS MCP" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="AIRS Module (src/airs/)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"AIRS Module Documentation","headline":"AIRS Module (src/airs/)","url":"http://localhost:4000/developers/src-airs/"}</script>
<!-- End Jekyll SEO tag -->

  
  <!-- Styles -->
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Rouge syntax highlighting is handled by Jekyll -->
  
  <!-- Favicons -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon-16x16.png">
</head>
<body>
  <nav class="navbar">
    <div class="container">
      <div class="navbar-brand">
        <a href="/" class="navbar-logo">
          <i class="fas fa-shield-alt"></i>
          Prisma AIRS MCP
        </a>
      </div>
      <div class="navbar-menu">
        <a href="/deployment" class="navbar-item ">Deployment</a>
        <a href="/developers" class="navbar-item active">Developers</a>
        <a href="/prisma-airs/overview" class="navbar-item ">Prisma AIRS</a>
        <a href="https://github.com/cdot65/prisma-airs-mcp" class="navbar-item">
          <i class="fab fa-github"></i>
        </a>
      </div>
    </div>
  </nav>

  <div class="documentation-layout">
    <aside class="sidebar">
      
<nav class="sidebar-nav">
  <h4>Getting Started</h4>
  <ul>
    <li><a href="/developers/overview/" >Overview</a></li>
  </ul>
  
  <h4>MCP Server Documentation</h4>
  <ul>
    <li><a href="/developers/client/" >AIRS Client Integration</a></li>
    <li><a href="/developers/resources/" >MCP Resources</a></li>
    <li><a href="/developers/tools/" >MCP Tools</a></li>
  </ul>
  
  <h4>Source Code Documentation</h4>
  <ul>
    <li><a href="/developers/src-root/" >Root (src/)</a></li>
    <li><a href="/developers/src-airs/" class="active">AIRS Module</a></li>
    <li><a href="/developers/src-config/" >Configuration</a></li>
    <li><a href="/developers/src-mcp/" >MCP Types</a></li>
    <li><a href="/developers/src-prompts/" >Prompts</a></li>
    <li><a href="/developers/src-resources/" >Resources</a></li>
    <li><a href="/developers/src-tools/" >Tools</a></li>
    <li><a href="/developers/src-transport/" >Transport</a></li>
    <li><a href="/developers/src-utils/" >Utilities</a></li>
  </ul>
  
  <h4>API</h4>
  <ul>
    <li><a href="/developers/api/" >API Reference</a></li>
  </ul>
</nav>



<style>
.sidebar-nav {
  padding: var(--spacing-md);
}

.sidebar-nav h4 {
  font-size: 0.875rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--gray);
  margin-bottom: var(--spacing-sm);
  margin-top: var(--spacing-lg);
}

.sidebar-nav h4:first-child {
  margin-top: 0;
}

.sidebar-nav ul {
  list-style: none;
  padding: 0;
  margin: 0 0 var(--spacing-md) 0;
}

.sidebar-nav li {
  margin-bottom: var(--spacing-xs);
}

.sidebar-nav a {
  display: block;
  padding: var(--spacing-xs) var(--spacing-sm);
  color: var(--dark);
  border-radius: var(--border-radius);
  font-size: 0.9375rem;
  transition: all 0.2s ease;
}

.sidebar-nav a:hover {
  background-color: var(--gray-light);
  text-decoration: none;
}

.sidebar-nav a.active {
  background-color: var(--primary);
  color: var(--white);
  font-weight: 500;
}

.sidebar-nav a.active:hover {
  background-color: var(--primary-dark);
}
</style>
    </aside>
    
    <main class="documentation-content">
      <div class="content-header">
        <h1>AIRS Module (src/airs/)</h1>
        
      </div>
      
      <article class="content">
        <h1 id="airs-module-documentation">AIRS Module Documentation</h1>

<p>The AIRS module provides a complete client implementation for integrating with Prisma AI Runtime Security (AIRS) API. It includes REST API communication, caching, rate limiting, and comprehensive type definitions.</p>

<h2 id="module-overview">Module Overview</h2>

<p>The AIRS module consists of six files that work together to provide a robust API client:</p>

<ul>
  <li><strong>types.ts</strong> - TypeScript type definitions for all AIRS API requests and responses</li>
  <li><strong>client.ts</strong> - Core REST API client with retry logic and error handling</li>
  <li><strong>cache.ts</strong> - LRU cache implementation for API response caching</li>
  <li><strong>rate-limiter.ts</strong> - Token bucket rate limiting to prevent API throttling</li>
  <li><strong>index.ts</strong> - Enhanced client that combines caching and rate limiting</li>
  <li><strong>factory.ts</strong> - Singleton factory for client instance management</li>
</ul>

<h2 id="file-documentation">File Documentation</h2>

<h3 id="typests---type-definitions">types.ts - Type Definitions</h3>

<p>This file contains all TypeScript interfaces and types generated from the Prisma AIRS OpenAPI schema.</p>

<h4 id="request-types">Request Types</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">ScanRequest</span> <span class="p">{</span>
    <span class="nl">tr_id</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>              <span class="c1">// Transaction ID for tracking</span>
    <span class="nl">ai_profile</span><span class="p">:</span> <span class="nx">AiProfile</span><span class="p">;</span>       <span class="c1">// Security profile configuration</span>
    <span class="nl">metadata</span><span class="p">?:</span> <span class="nx">Metadata</span><span class="p">;</span>         <span class="c1">// Optional metadata</span>
    <span class="nl">contents</span><span class="p">:</span> <span class="nx">ContentItem</span><span class="p">[];</span>     <span class="c1">// Content to scan</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">ContentItem</span> <span class="p">{</span>
    <span class="nl">prompt</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>             <span class="c1">// User input to scan</span>
    <span class="nl">response</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>           <span class="c1">// AI response to scan</span>
    <span class="nl">code_prompt</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>        <span class="c1">// Code in prompt</span>
    <span class="nl">code_response</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>      <span class="c1">// Code in response</span>
    <span class="nl">context</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>            <span class="c1">// Additional context</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="response-types">Response Types</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">ScanResponse</span> <span class="p">{</span>
    <span class="nl">report_id</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">scan_id</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">tr_id</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">profile_id</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">profile_name</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">category</span><span class="p">:</span> <span class="dl">'</span><span class="s1">malicious</span><span class="dl">'</span> <span class="o">|</span> <span class="dl">'</span><span class="s1">benign</span><span class="dl">'</span><span class="p">;</span>
    <span class="nl">action</span><span class="p">:</span> <span class="dl">'</span><span class="s1">block</span><span class="dl">'</span> <span class="o">|</span> <span class="dl">'</span><span class="s1">allow</span><span class="dl">'</span><span class="p">;</span>
    <span class="nl">prompt_detected</span><span class="p">?:</span> <span class="nx">PromptDetected</span><span class="p">;</span>
    <span class="nl">response_detected</span><span class="p">?:</span> <span class="nx">ResponseDetected</span><span class="p">;</span>
    <span class="c1">// ... additional fields</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="threat-detection-types">Threat Detection Types</h4>

<p>The response includes detailed threat detection for both prompts and responses:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">PromptDetected</span> <span class="p">{</span>
    <span class="nl">url_cats</span><span class="p">?:</span> <span class="nx">boolean</span><span class="p">;</span>          <span class="c1">// Malicious URL categories</span>
    <span class="nl">dlp</span><span class="p">?:</span> <span class="nx">boolean</span><span class="p">;</span>               <span class="c1">// Data loss prevention</span>
    <span class="nl">injection</span><span class="p">?:</span> <span class="nx">boolean</span><span class="p">;</span>         <span class="c1">// Prompt injection</span>
    <span class="nl">toxic_content</span><span class="p">?:</span> <span class="nx">boolean</span><span class="p">;</span>     <span class="c1">// Toxic/harmful content</span>
    <span class="nl">malicious_code</span><span class="p">?:</span> <span class="nx">boolean</span><span class="p">;</span>    <span class="c1">// Malicious code detection</span>
    <span class="nl">agent</span><span class="p">?:</span> <span class="nx">boolean</span><span class="p">;</span>             <span class="c1">// AI agent threats</span>
    <span class="nl">topic_violation</span><span class="p">?:</span> <span class="nx">boolean</span><span class="p">;</span>   <span class="c1">// Topic guardrail violations</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="clientts---core-api-client">client.ts - Core API Client</h3>

<p>The base client handles all HTTP communication with the AIRS API.</p>

<h4 id="client-configuration">Client Configuration</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">AIRSClientConfig</span> <span class="p">{</span>
    <span class="nl">apiUrl</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>              <span class="c1">// AIRS API endpoint</span>
    <span class="nl">apiKey</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>              <span class="c1">// Authentication token</span>
    <span class="nl">timeout</span><span class="p">?:</span> <span class="kr">number</span><span class="p">;</span>            <span class="c1">// Request timeout (default: 30000ms)</span>
    <span class="nl">maxRetries</span><span class="p">?:</span> <span class="kr">number</span><span class="p">;</span>         <span class="c1">// Retry attempts (default: 3)</span>
    <span class="nl">retryDelay</span><span class="p">?:</span> <span class="kr">number</span><span class="p">;</span>         <span class="c1">// Initial retry delay (default: 1000ms)</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="main-client-class">Main Client Class</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">PrismaAIRSClient</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">config</span><span class="p">:</span> <span class="nx">AIRSClientConfig</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Initializes with configuration</span>
        <span class="c1">// Sets up base URL with version</span>
        <span class="c1">// Configures retry and timeout settings</span>
    <span class="p">}</span>

    <span class="c1">// Synchronous scanning</span>
    <span class="k">async</span> <span class="nx">scanSync</span><span class="p">(</span><span class="nx">request</span><span class="p">:</span> <span class="nx">ScanRequest</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ScanResponse</span><span class="o">&gt;</span>

    <span class="c1">// Asynchronous batch scanning</span>
    <span class="k">async</span> <span class="nx">scanAsync</span><span class="p">(</span><span class="nx">requests</span><span class="p">:</span> <span class="nx">AsyncScanObject</span><span class="p">[]):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">AsyncScanResponse</span><span class="o">&gt;</span>

    <span class="c1">// Retrieve scan results by IDs</span>
    <span class="k">async</span> <span class="nx">getScanResults</span><span class="p">(</span><span class="nx">scanIds</span><span class="p">:</span> <span class="kr">string</span><span class="p">[]):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ScanIdResult</span><span class="p">[]</span><span class="o">&gt;</span>

    <span class="c1">// Get detailed threat reports</span>
    <span class="k">async</span> <span class="nx">getThreatScanReports</span><span class="p">(</span><span class="nx">reportIds</span><span class="p">:</span> <span class="kr">string</span><span class="p">[]):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ThreatScanReportObject</span><span class="p">[]</span><span class="o">&gt;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="error-handling">Error Handling</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">AIRSAPIError</span> <span class="kd">extends</span> <span class="nb">Error</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span>
        <span class="nx">message</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
        <span class="k">public</span> <span class="nx">statusCode</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
        <span class="k">public</span> <span class="nx">response</span><span class="p">?:</span> <span class="nx">AIRSErrorResponse</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">AIRSAPIError</span><span class="dl">'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The client implements:</p>
<ul>
  <li>Automatic retry with exponential backoff</li>
  <li>Rate limit handling (429 responses)</li>
  <li>Network error recovery</li>
  <li>Structured error responses</li>
</ul>

<h3 id="cachets---response-caching">cache.ts - Response Caching</h3>

<p>Implements a size-based cache with TTL (Time-To-Live) to reduce API calls and improve performance.</p>

<h4 id="cache-configuration">Cache Configuration</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">CacheConfig</span> <span class="p">{</span>
    <span class="nl">ttlSeconds</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>          <span class="c1">// Time-to-live in seconds</span>
    <span class="nl">maxSize</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>             <span class="c1">// Maximum cache size in bytes</span>
    <span class="nl">enabled</span><span class="p">?:</span> <span class="nx">boolean</span><span class="p">;</span>           <span class="c1">// Enable/disable caching</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="cache-implementation">Cache Implementation</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">AIRSCache</span> <span class="p">{</span>
    <span class="c1">// Set a value with optional TTL override</span>
    <span class="kd">set</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">data</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span> <span class="nx">ttlOverride</span><span class="p">?:</span> <span class="kr">number</span><span class="p">):</span> <span class="k">void</span>

    <span class="c1">// Get a value if not expired</span>
    <span class="kd">get</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span>

    <span class="c1">// Clear all cached entries</span>
    <span class="nx">clear</span><span class="p">():</span> <span class="k">void</span>

    <span class="c1">// Get cache statistics</span>
    <span class="nx">getStats</span><span class="p">():</span> <span class="p">{</span>
        <span class="nl">size</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>            <span class="c1">// Current size in bytes</span>
        <span class="nl">count</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>           <span class="c1">// Number of entries</span>
        <span class="nl">enabled</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>        <span class="c1">// Cache status</span>
    <span class="p">}</span>

    <span class="c1">// Generate cache keys</span>
    <span class="k">static</span> <span class="nx">generateScanKey</span><span class="p">(</span><span class="nx">method</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">data</span><span class="p">:</span> <span class="nx">unknown</span><span class="p">):</span> <span class="kr">string</span>
    <span class="k">static</span> <span class="nx">generateResultKey</span><span class="p">(</span><span class="kd">type</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">ids</span><span class="p">:</span> <span class="kr">string</span><span class="p">[]):</span> <span class="kr">string</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Key features:</p>
<ul>
  <li>Simple hash-based cache key generation</li>
  <li>Automatic expiration of old entries</li>
  <li>Size-based eviction when capacity reached</li>
  <li>Periodic cleanup of expired entries</li>
  <li>Memory size estimation for entries</li>
</ul>

<h3 id="rate-limiterts---api-rate-limiting">rate-limiter.ts - API Rate Limiting</h3>

<p>Implements token bucket algorithm to prevent API throttling.</p>

<h4 id="rate-limiter-configuration">Rate Limiter Configuration</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">RateLimiterConfig</span> <span class="p">{</span>
    <span class="nl">maxRequests</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>         <span class="c1">// Maximum requests allowed</span>
    <span class="nl">windowMs</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>            <span class="c1">// Time window in milliseconds</span>
    <span class="nl">enabled</span><span class="p">?:</span> <span class="nx">boolean</span><span class="p">;</span>           <span class="c1">// Enable/disable rate limiting</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="rate-limiter-implementation">Rate Limiter Implementation</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">AIRSRateLimiter</span> <span class="p">{</span>
    <span class="c1">// Check if request is allowed and consume token</span>
    <span class="nx">checkLimit</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">default</span><span class="dl">'</span><span class="p">):</span> <span class="nx">boolean</span>

    <span class="c1">// Wait until rate limit allows request</span>
    <span class="k">async</span> <span class="nx">waitForLimit</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">default</span><span class="dl">'</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span>

    <span class="c1">// Get current rate limit status</span>
    <span class="nx">getStatus</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">default</span><span class="dl">'</span><span class="p">):</span> <span class="p">{</span>
        <span class="nl">available</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
        <span class="nl">limit</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
        <span class="nl">resetAt</span><span class="p">:</span> <span class="nb">Date</span><span class="p">;</span>
    <span class="p">}</span> <span class="o">|</span> <span class="kc">null</span>

    <span class="c1">// Reset rate limit for specific key</span>
    <span class="nx">reset</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">default</span><span class="dl">'</span><span class="p">):</span> <span class="k">void</span>

    <span class="c1">// Clear all rate limit buckets</span>
    <span class="nx">clear</span><span class="p">():</span> <span class="k">void</span>

    <span class="c1">// Get statistics for monitoring</span>
    <span class="nx">getStats</span><span class="p">():</span> <span class="p">{</span>
        <span class="nl">bucketCount</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
        <span class="nl">enabled</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The rate limiter uses a token bucket algorithm with configurable limits per operation key. It automatically refills tokens based on the time window and tracks usage per operation type.</p>

<h3 id="indexts---enhanced-client">index.ts - Enhanced Client</h3>

<p>Combines the base client with caching and rate limiting capabilities.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">EnhancedPrismaAIRSClient</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">config</span><span class="p">:</span> <span class="nx">EnhancedAIRSClientConfig</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Initializes base client</span>
        <span class="c1">// Sets up optional cache</span>
        <span class="c1">// Configures optional rate limiter</span>
    <span class="p">}</span>

    <span class="c1">// All base client methods with enhancements</span>
    <span class="k">async</span> <span class="nx">scanSync</span><span class="p">(</span><span class="nx">request</span><span class="p">:</span> <span class="nx">ScanRequest</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ScanResponse</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="c1">// 1. Check rate limit</span>
        <span class="c1">// 2. Check cache</span>
        <span class="c1">// 3. Make API call if needed</span>
        <span class="c1">// 4. Cache successful response</span>
        <span class="c1">// 5. Return result</span>
    <span class="p">}</span>

    <span class="c1">// Cache management</span>
    <span class="nx">getCacheStats</span><span class="p">():</span> <span class="nx">CacheStats</span> <span class="o">|</span> <span class="kc">null</span>
    <span class="nx">clearCache</span><span class="p">():</span> <span class="k">void</span>

    <span class="c1">// Rate limit management</span>
    <span class="nx">getRateLimiterStats</span><span class="p">():</span> <span class="nx">RateLimiterStats</span> <span class="o">|</span> <span class="kc">null</span>
    <span class="nx">resetRateLimits</span><span class="p">():</span> <span class="k">void</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="factoryts---client-factory">factory.ts - Client Factory</h3>

<p>Provides singleton instance management for the AIRS client.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">clientInstance</span><span class="p">:</span> <span class="nx">EnhancedPrismaAIRSClient</span> <span class="o">|</span> <span class="kc">null</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nx">getAIRSClient</span><span class="p">():</span> <span class="nx">EnhancedPrismaAIRSClient</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">clientInstance</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="nx">getConfig</span><span class="p">();</span>
        <span class="nx">clientInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">EnhancedPrismaAIRSClient</span><span class="p">({</span>
            <span class="na">apiUrl</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">airs</span><span class="p">.</span><span class="nx">apiUrl</span><span class="p">,</span>
            <span class="na">apiKey</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">airs</span><span class="p">.</span><span class="nx">apiKey</span><span class="p">,</span>
            <span class="na">timeout</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">airs</span><span class="p">.</span><span class="nx">timeout</span><span class="p">,</span>
            <span class="na">maxRetries</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">airs</span><span class="p">.</span><span class="nx">retryAttempts</span><span class="p">,</span>
            <span class="na">retryDelay</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">airs</span><span class="p">.</span><span class="nx">retryDelay</span><span class="p">,</span>
            <span class="na">cache</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">enabled</span> <span class="p">?</span> <span class="p">{</span>
                <span class="na">ttlSeconds</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">ttlSeconds</span><span class="p">,</span>
                <span class="na">maxSize</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">maxSize</span><span class="p">,</span>
                <span class="na">enabled</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">enabled</span><span class="p">,</span>
            <span class="p">}</span> <span class="p">:</span> <span class="kc">undefined</span><span class="p">,</span>
            <span class="na">rateLimiter</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">rateLimit</span><span class="p">.</span><span class="nx">enabled</span> <span class="p">?</span> <span class="p">{</span>
                <span class="na">maxRequests</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">rateLimit</span><span class="p">.</span><span class="nx">maxRequests</span><span class="p">,</span>
                <span class="na">windowMs</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">rateLimit</span><span class="p">.</span><span class="nx">windowMs</span><span class="p">,</span>
                <span class="na">enabled</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">rateLimit</span><span class="p">.</span><span class="nx">enabled</span><span class="p">,</span>
            <span class="p">}</span> <span class="p">:</span> <span class="kc">undefined</span><span class="p">,</span>
        <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">clientInstance</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nx">resetAIRSClient</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">clientInstance</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">clientInstance</span><span class="p">.</span><span class="nx">clearCache</span><span class="p">();</span>
        <span class="nx">clientInstance</span><span class="p">.</span><span class="nx">resetRateLimits</span><span class="p">();</span>
        <span class="nx">clientInstance</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="usage-examples">Usage Examples</h2>

<h3 id="basic-scanning">Basic Scanning</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">getAIRSClient</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./airs/factory</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="nx">getAIRSClient</span><span class="p">();</span>

<span class="c1">// Scan content synchronously</span>
<span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">scanSync</span><span class="p">({</span>
    <span class="na">ai_profile</span><span class="p">:</span> <span class="p">{</span> <span class="na">profile_name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Prisma AIRS</span><span class="dl">'</span> <span class="p">},</span>
    <span class="na">contents</span><span class="p">:</span> <span class="p">[{</span>
        <span class="na">prompt</span><span class="p">:</span> <span class="dl">'</span><span class="s1">User input to check</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">response</span><span class="p">:</span> <span class="dl">'</span><span class="s1">AI response to verify</span><span class="dl">'</span>
    <span class="p">}]</span>
<span class="p">});</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">category</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">malicious</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Threat detected:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">result</span><span class="p">.</span><span class="nx">action</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="batch-scanning">Batch Scanning</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Scan multiple items asynchronously</span>
<span class="kd">const</span> <span class="nx">asyncResult</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">scanAsync</span><span class="p">([</span>
    <span class="p">{</span>
        <span class="na">req_id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="na">scan_req</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">ai_profile</span><span class="p">:</span> <span class="p">{</span> <span class="na">profile_name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Prisma AIRS</span><span class="dl">'</span> <span class="p">},</span>
            <span class="na">contents</span><span class="p">:</span> <span class="p">[{</span> <span class="na">prompt</span><span class="p">:</span> <span class="dl">'</span><span class="s1">First item</span><span class="dl">'</span> <span class="p">}]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="na">req_id</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="na">scan_req</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">ai_profile</span><span class="p">:</span> <span class="p">{</span> <span class="na">profile_name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Prisma AIRS</span><span class="dl">'</span> <span class="p">},</span>
            <span class="na">contents</span><span class="p">:</span> <span class="p">[{</span> <span class="na">prompt</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Second item</span><span class="dl">'</span> <span class="p">}]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">]);</span>

<span class="c1">// Poll for results</span>
<span class="kd">const</span> <span class="nx">results</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">getScanResults</span><span class="p">([</span><span class="nx">asyncResult</span><span class="p">.</span><span class="nx">scan_id</span><span class="p">]);</span>
</code></pre></div></div>

<h3 id="cache-management">Cache Management</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Get cache statistics</span>
<span class="kd">const</span> <span class="nx">stats</span> <span class="o">=</span> <span class="nx">client</span><span class="p">.</span><span class="nx">getCacheStats</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">stats</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Cache size: </span><span class="p">${</span><span class="nx">stats</span><span class="p">.</span><span class="nx">size</span><span class="p">}</span><span class="s2"> bytes`</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Cache entries: </span><span class="p">${</span><span class="nx">stats</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Cache enabled: </span><span class="p">${</span><span class="nx">stats</span><span class="p">.</span><span class="nx">enabled</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Clear cache when needed</span>
<span class="nx">client</span><span class="p">.</span><span class="nx">clearCache</span><span class="p">();</span>
</code></pre></div></div>

<h2 id="error-handling-1">Error Handling</h2>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">scanSync</span><span class="p">(</span><span class="nx">request</span><span class="p">);</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">error</span> <span class="k">instanceof</span> <span class="nx">AIRSAPIError</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">case</span> <span class="mi">401</span><span class="p">:</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Invalid API key</span><span class="dl">'</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="mi">429</span><span class="p">:</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Rate limited - will retry automatically</span><span class="dl">'</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="mi">500</span><span class="p">:</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">AIRS service error</span><span class="dl">'</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="configuration">Configuration</h2>

<p>The module uses environment variables via the config system:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Required</span>
<span class="nv">AIRS_API_URL</span><span class="o">=</span>https://api.prismacloud.io/airs
<span class="nv">AIRS_API_KEY</span><span class="o">=</span>your-api-key

<span class="c"># Optional AIRS settings</span>
<span class="nv">AIRS_TIMEOUT</span><span class="o">=</span>30000
<span class="nv">AIRS_RETRY_ATTEMPTS</span><span class="o">=</span>3
<span class="nv">AIRS_RETRY_DELAY</span><span class="o">=</span>1000

<span class="c"># Cache settings</span>
<span class="nv">CACHE_ENABLED</span><span class="o">=</span><span class="nb">true
</span><span class="nv">CACHE_MAX_SIZE</span><span class="o">=</span>10485760  <span class="c"># 10MB in bytes</span>
<span class="nv">CACHE_TTL_SECONDS</span><span class="o">=</span>300    <span class="c"># 5 minutes</span>

<span class="c"># Rate limiting</span>
<span class="nv">RATE_LIMIT_ENABLED</span><span class="o">=</span><span class="nb">true
</span><span class="nv">RATE_LIMIT_MAX_REQUESTS</span><span class="o">=</span>10
<span class="nv">RATE_LIMIT_WINDOW_MS</span><span class="o">=</span>60000  <span class="c"># 1 minute</span>
</code></pre></div></div>

<h2 id="best-practices">Best Practices</h2>

<ol>
  <li><strong>Use the factory</strong> - Always get the client via <code class="language-plaintext highlighter-rouge">getAIRSClient()</code> for proper singleton management</li>
  <li><strong>Handle errors</strong> - Implement proper error handling for API failures</li>
  <li><strong>Monitor cache</strong> - Check cache statistics to ensure good hit rates</li>
  <li><strong>Batch when possible</strong> - Use async scanning for multiple items</li>
  <li><strong>Respect rate limits</strong> - The client handles this automatically but monitor usage</li>
</ol>

<h2 id="integration-with-mcp">Integration with MCP</h2>

<p>The AIRS module is used by:</p>
<ul>
  <li><strong>Tool handlers</strong> - Execute security scans via MCP tools</li>
  <li><strong>Resource handlers</strong> - Retrieve scan results and reports</li>
  <li><strong>Transport layer</strong> - Provides scan status for long operations</li>
</ul>

<h2 id="next-steps">Next Steps</h2>

<ul>
  <li><a href="/developers/src-tools/">MCP Tools</a> - How tools use the AIRS client</li>
  <li><a href="/developers/src-config/">Configuration</a> - Detailed configuration options</li>
  <li><a href="/developers/src-transport/">Transport Layer</a> - Request handling and routing</li>
</ul>

      </article>
      
      <div class="content-footer">
        <div class="edit-page">
          <a href="https://github.com/cdot65/prisma-airs-mcp/edit/main/docs/_developers/src-airs.md">
            <i class="fas fa-edit"></i> Edit this page on GitHub
          </a>
        </div>
        
        
        <div class="pagination">
          
          
          <a href="/developers/src-root/" class="next">
            Root Module (src/) <i class="fas fa-arrow-right"></i>
          </a>
          
        </div>
        
      </div>
    </main>
    
    <aside class="toc">
      <h4>On this page</h4>
      <nav id="table-of-contents"></nav>
    </aside>
  </div>

  <!-- Syntax highlighting is handled by Jekyll Rouge -->
  <script src="/assets/js/main.js"></script>
</body>
</html>