<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Kubernetes Deployment Configuration Guide - Prisma AIRS MCP</title>
  <meta name="description" content="AI Runtime Security through Model Context Protocol - Secure your AI applications with enterprise-grade threat detection">
  
  <!-- SEO -->
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Kubernetes Deployment Configuration Guide" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="AI Runtime Security through Model Context Protocol - Secure your AI applications with enterprise-grade threat detection" />
<meta property="og:description" content="AI Runtime Security through Model Context Protocol - Secure your AI applications with enterprise-grade threat detection" />
<link rel="canonical" href="https://cdot65.github.io/prisma-airs-mcp/KUBERNETES-DEPLOYMENT-GUIDE.html" />
<meta property="og:url" content="https://cdot65.github.io/prisma-airs-mcp/KUBERNETES-DEPLOYMENT-GUIDE.html" />
<meta property="og:site_name" content="Prisma AIRS MCP" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Kubernetes Deployment Configuration Guide" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"AI Runtime Security through Model Context Protocol - Secure your AI applications with enterprise-grade threat detection","headline":"Kubernetes Deployment Configuration Guide","url":"https://cdot65.github.io/prisma-airs-mcp/KUBERNETES-DEPLOYMENT-GUIDE.html"}</script>
<!-- End Jekyll SEO tag -->

  
  <!-- CSS -->
  <link rel="stylesheet" href="/prisma-airs-mcp/assets/css/style.css">
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="/prisma-airs-mcp/assets/favicon.png">
</head>
<body>
  <h1 id="kubernetes-deployment-configuration-guide">Kubernetes Deployment Configuration Guide</h1>

<p>This guide covers all configuration items that need to be updated when deploying the Prisma AIRS MCP server to different Kubernetes environments.</p>

<h2 id="table-of-contents">Table of Contents</h2>
<ul>
  <li><a href="#environment-specific-configurations">Environment-Specific Configurations</a></li>
  <li><a href="#secrets-and-sensitive-data">Secrets and Sensitive Data</a></li>
  <li><a href="#configmaps-and-application-settings">ConfigMaps and Application Settings</a></li>
  <li><a href="#kubernetes-resources">Kubernetes Resources</a></li>
  <li><a href="#github-container-registry">GitHub Container Registry</a></li>
  <li><a href="#deployment-checklist">Deployment Checklist</a></li>
</ul>

<h2 id="environment-specific-configurations">Environment-Specific Configurations</h2>

<h3 id="1-kubernetes-namespace">1. Kubernetes Namespace</h3>

<p>The namespace is configured in multiple locations:</p>

<p><strong>Files to update:</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">k8s/base/kustomization.yaml</code>
    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">namespace</span><span class="pi">:</span> <span class="s">prisma-airs</span>  <span class="c1"># Change this to your namespace</span>
</code></pre></div>    </div>
  </li>
</ul>

<p><strong>Commands that use namespace:</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Update namespace in deployment scripts</span>
./k8s/scripts/deploy.sh deploy production  <span class="c"># Uses namespace from kustomization</span>
kubectl create namespace your-namespace     <span class="c"># Create your namespace</span>
</code></pre></div></div>

<h3 id="2-environment-variables">2. Environment Variables</h3>

<p>Environment-specific settings are configured in overlay directories:</p>

<p><strong>Files to update:</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">k8s/overlays/development/kustomization.yaml</code></li>
  <li><code class="language-plaintext highlighter-rouge">k8s/overlays/staging/kustomization.yaml</code></li>
  <li><code class="language-plaintext highlighter-rouge">k8s/overlays/production/kustomization.yaml</code></li>
</ul>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">configMapGenerator</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">prisma-airs-mcp-config</span>
  <span class="na">behavior</span><span class="pi">:</span> <span class="s">merge</span>
  <span class="na">literals</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">airs.api.url=https://service.api.aisecurity.paloaltonetworks.com</span>
  <span class="pi">-</span> <span class="s">cache.ttl.seconds=300</span>
  <span class="pi">-</span> <span class="s">rate.limit.max.requests=100</span>
  <span class="pi">-</span> <span class="s">airs.default.profile.name=Prisma AIRS</span>  <span class="c1"># Your default profile name</span>
  <span class="c1"># - airs.default.profile.id=profile-123   # Or use profile ID instead</span>
</code></pre></div></div>

<h3 id="3-deployment-configurations">3. Deployment Configurations</h3>

<p><strong>Files to update:</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">k8s/overlays/{environment}/deployment-patch.yaml</code></li>
</ul>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">3</span>  <span class="c1"># Adjust based on environment</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">prisma-airs-mcp</span>
        <span class="na">env</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">NODE_ENV</span>
          <span class="na">value</span><span class="pi">:</span> <span class="s">production</span>  <span class="c1"># development, staging, or production</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">LOG_LEVEL</span>
          <span class="na">value</span><span class="pi">:</span> <span class="s">warn</span>       <span class="c1"># debug, info, warn, or error</span>
        <span class="na">resources</span><span class="pi">:</span>
          <span class="na">requests</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">256Mi"</span>  <span class="c1"># Adjust based on needs</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">500m"</span>
          <span class="na">limits</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1Gi"</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2000m"</span>
</code></pre></div></div>

<h2 id="secrets-and-sensitive-data">Secrets and Sensitive Data</h2>

<h3 id="1-prisma-airs-api-key">1. Prisma AIRS API Key</h3>

<p>The API key must be created as a Kubernetes secret:</p>

<p><strong>Option A: Using the management script (recommended)</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create secret with your API key</span>
./k8s/scripts/manage-secrets.sh create prisma-airs <span class="s1">'your-actual-api-key-here'</span>
</code></pre></div></div>

<p><strong>Option B: Manual creation</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl create secret generic prisma-airs-mcp-secrets <span class="se">\</span>
  <span class="nt">--from-literal</span><span class="o">=</span>airs.api.key<span class="o">=</span><span class="s1">'your-actual-api-key-here'</span> <span class="se">\</span>
  <span class="nt">--namespace</span><span class="o">=</span>your-namespace
</code></pre></div></div>

<p><strong>Option C: In production overlay (for GitOps)</strong></p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># k8s/overlays/production/kustomization.yaml</span>
<span class="na">secretGenerator</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">prisma-airs-mcp-secrets</span>
  <span class="na">behavior</span><span class="pi">:</span> <span class="s">replace</span>
  <span class="na">literals</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">airs.api.key=your-actual-api-key-here</span>  <span class="c1"># Never commit real keys!</span>
</code></pre></div></div>

<h3 id="2-github-container-registry-access">2. GitHub Container Registry Access</h3>

<p>For private registries, create a pull secret:</p>

<p><strong>Create the secret:</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Set your GitHub Personal Access Token</span>
<span class="nb">export </span><span class="nv">CR_PAT</span><span class="o">=</span><span class="s1">'your-github-personal-access-token'</span>

<span class="c"># Create the secret</span>
./k8s/scripts/create-registry-secret.sh create
</code></pre></div></div>

<p><strong>Or manually:</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl create secret docker-registry ghcr-login-secret <span class="se">\</span>
  <span class="nt">--docker-server</span><span class="o">=</span>ghcr.io <span class="se">\</span>
  <span class="nt">--docker-username</span><span class="o">=</span>your-github-username <span class="se">\</span>
  <span class="nt">--docker-password</span><span class="o">=</span>your-github-pat <span class="se">\</span>
  <span class="nt">--docker-email</span><span class="o">=</span>your-email@example.com <span class="se">\</span>
  <span class="nt">--namespace</span><span class="o">=</span>your-namespace
</code></pre></div></div>

<h2 id="configmaps-and-application-settings">ConfigMaps and Application Settings</h2>

<h3 id="1-core-application-configuration">1. Core Application Configuration</h3>

<p><strong>Base configuration</strong> (<code class="language-plaintext highlighter-rouge">k8s/base/kustomization.yaml</code>):</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">configMapGenerator</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">prisma-airs-mcp-config</span>
  <span class="na">literals</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">airs.api.url=https://service.api.aisecurity.paloaltonetworks.com</span>
  <span class="pi">-</span> <span class="s">cache.enabled=true</span>
  <span class="pi">-</span> <span class="s">cache.ttl.seconds=300</span>
  <span class="pi">-</span> <span class="s">cache.max.size=1000</span>
  <span class="pi">-</span> <span class="s">rate.limit.enabled=true</span>
  <span class="pi">-</span> <span class="s">rate.limit.max.requests=100</span>
  <span class="pi">-</span> <span class="s">rate.limit.window.ms=60000</span>
</code></pre></div></div>

<h3 id="2-profile-configuration">2. Profile Configuration</h3>

<p>Configure default AIRS profiles via ConfigMap:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># In your overlay kustomization.yaml</span>
<span class="na">configMapGenerator</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">prisma-airs-mcp-config</span>
  <span class="na">behavior</span><span class="pi">:</span> <span class="s">merge</span>
  <span class="na">literals</span><span class="pi">:</span>
  <span class="c1"># Option 1: Use profile name (recommended)</span>
  <span class="pi">-</span> <span class="s">airs.default.profile.name=Your Profile Name</span>
  
  <span class="c1"># Option 2: Use profile ID</span>
  <span class="c1"># - airs.default.profile.id=12345-67890-abcdef</span>
</code></pre></div></div>

<h3 id="3-additional-environment-variables">3. Additional Environment Variables</h3>

<p><strong>Optional configurations</strong> (add to deployment patches):</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">env</span><span class="pi">:</span>
<span class="c1"># Cache settings</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">CACHE_ENABLED</span>
  <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">CACHE_TTL_SECONDS</span>
  <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">300"</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">CACHE_MAX_SIZE</span>
  <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1000"</span>

<span class="c1"># Rate limiting</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">RATE_LIMIT_ENABLED</span>
  <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">RATE_LIMIT_MAX_REQUESTS</span>
  <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">100"</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">RATE_LIMIT_WINDOW_MS</span>
  <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">60000"</span>

<span class="c1"># MCP settings</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MCP_SERVER_NAME</span>
  <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">prisma-airs-mcp"</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MCP_SERVER_VERSION</span>
  <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1.3.4"</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MCP_PROTOCOL_VERSION</span>
  <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2024-11-05"</span>

<span class="c1"># Server settings</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">PORT</span>
  <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">3000"</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">NODE_ENV</span>
  <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">production"</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">LOG_LEVEL</span>
  <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">info"</span>
</code></pre></div></div>

<h2 id="kubernetes-resources">Kubernetes Resources</h2>

<h3 id="1-ingress-configuration">1. Ingress Configuration</h3>

<p><strong>For Traefik</strong> (<code class="language-plaintext highlighter-rouge">k8s/base/ingressroute.yaml</code>):</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spec</span><span class="pi">:</span>
  <span class="na">routes</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">match</span><span class="pi">:</span> <span class="s">Host(`your-domain.com`) &amp;&amp; PathPrefix(`/your-path`)</span>
    <span class="na">services</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">prisma-airs-mcp</span>
      <span class="na">port</span><span class="pi">:</span> <span class="m">80</span>
</code></pre></div></div>

<p><strong>For Nginx Ingress</strong>:</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">prisma-airs-mcp</span>
  <span class="na">annotations</span><span class="pi">:</span>
    <span class="na">nginx.ingress.kubernetes.io/rewrite-target</span><span class="pi">:</span> <span class="s">/</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">rules</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">host</span><span class="pi">:</span> <span class="s">your-domain.com</span>
    <span class="na">http</span><span class="pi">:</span>
      <span class="na">paths</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">/your-path</span>
        <span class="na">pathType</span><span class="pi">:</span> <span class="s">Prefix</span>
        <span class="na">backend</span><span class="pi">:</span>
          <span class="na">service</span><span class="pi">:</span>
            <span class="na">name</span><span class="pi">:</span> <span class="s">prisma-airs-mcp</span>
            <span class="na">port</span><span class="pi">:</span>
              <span class="na">number</span><span class="pi">:</span> <span class="m">80</span>
</code></pre></div></div>

<h3 id="2-tlsssl-certificates">2. TLS/SSL Certificates</h3>

<p><strong>Update certificate references</strong>:</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># In your IngressRoute</span>
<span class="na">tls</span><span class="pi">:</span>
  <span class="na">secretName</span><span class="pi">:</span> <span class="s">your-tls-certificate-secret</span>
</code></pre></div></div>

<h3 id="3-service-configuration">3. Service Configuration</h3>

<p>The service is defined in <code class="language-plaintext highlighter-rouge">k8s/base/service.yaml</code> and typically doesnâ€™t need changes, but you can adjust:</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spec</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">ClusterIP</span>  <span class="c1"># Or LoadBalancer, NodePort</span>
  <span class="na">ports</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">http</span>
    <span class="na">port</span><span class="pi">:</span> <span class="m">80</span>
    <span class="na">targetPort</span><span class="pi">:</span> <span class="s">http</span>
    <span class="na">protocol</span><span class="pi">:</span> <span class="s">TCP</span>
</code></pre></div></div>

<h2 id="github-container-registry">GitHub Container Registry</h2>

<h3 id="1-image-references">1. Image References</h3>

<p><strong>Update image location</strong> in overlays:</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># k8s/overlays/production/kustomization.yaml</span>
<span class="na">images</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">ghcr.io/cdot65/prisma-airs-mcp</span>
  <span class="na">newTag</span><span class="pi">:</span> <span class="s">v1.3.4</span>  <span class="c1"># Your version tag</span>
</code></pre></div></div>

<p><strong>For custom registry:</strong></p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">images</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">ghcr.io/cdot65/prisma-airs-mcp</span>
  <span class="na">newName</span><span class="pi">:</span> <span class="s">your-registry.com/your-org/prisma-airs-mcp</span>
  <span class="na">newTag</span><span class="pi">:</span> <span class="s">v1.3.4</span>
</code></pre></div></div>

<h3 id="2-build-and-push-configuration">2. Build and Push Configuration</h3>

<p><strong>Update registry in scripts</strong>:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># scripts/docker-publish.sh</span>
<span class="nv">REGISTRY</span><span class="o">=</span><span class="s2">"your-registry.com"</span>  <span class="c"># Default: ghcr.io</span>
<span class="nv">USERNAME</span><span class="o">=</span><span class="s2">"your-username"</span>       <span class="c"># Default: cdot65</span>
<span class="nv">IMAGE_NAME</span><span class="o">=</span><span class="s2">"prisma-airs-mcp"</span>
</code></pre></div></div>

<h2 id="deployment-checklist">Deployment Checklist</h2>

<h3 id="pre-deployment">Pre-Deployment</h3>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><strong>Example Files</strong>: Copy and configure example files for production
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cp </span>k8s/overlays/production/kustomization.yaml.example k8s/overlays/production/kustomization.yaml
<span class="c"># Edit to add your API key or use manage-secrets.sh instead</span>
</code></pre></div>    </div>
  </li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><strong>Namespace</strong>: Create/verify namespace exists</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><strong>API Key</strong>: Create secret with correct Prisma AIRS API key</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><strong>Registry Access</strong>: Create pull secret if using private registry</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><strong>Profile Config</strong>: Set default profile name or ID in ConfigMap</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><strong>Domain/Ingress</strong>: Update ingress configuration for your domain</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><strong>TLS Certificate</strong>: Ensure certificate secret exists</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><strong>Resource Limits</strong>: Adjust CPU/memory based on cluster capacity</li>
</ul>

<h3 id="configuration-files-to-review">Configuration Files to Review</h3>

<ol>
  <li><strong>Base Resources</strong>:
    <ul class="task-list">
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><code class="language-plaintext highlighter-rouge">k8s/base/kustomization.yaml</code> - namespace</li>
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><code class="language-plaintext highlighter-rouge">k8s/base/deployment.yaml</code> - if modifying base config</li>
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><code class="language-plaintext highlighter-rouge">k8s/base/ingressroute.yaml</code> - domain and path</li>
    </ul>
  </li>
  <li><strong>Environment Overlays</strong>:
    <ul class="task-list">
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><code class="language-plaintext highlighter-rouge">k8s/overlays/{env}/kustomization.yaml</code> - ConfigMap values</li>
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><code class="language-plaintext highlighter-rouge">k8s/overlays/{env}/deployment-patch.yaml</code> - resources, replicas</li>
    </ul>
  </li>
  <li><strong>Scripts Configuration</strong>:
    <ul class="task-list">
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><code class="language-plaintext highlighter-rouge">.env</code> - local environment variables</li>
      <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Update script variables if using custom registry</li>
    </ul>
  </li>
</ol>

<h3 id="deployment-commands">Deployment Commands</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 1. Set environment variables</span>
<span class="nb">export </span><span class="nv">CR_PAT</span><span class="o">=</span><span class="s1">'your-github-pat'</span>
<span class="nb">export </span><span class="nv">GITHUB_TOKEN</span><span class="o">=</span><span class="s1">'your-github-token'</span>

<span class="c"># 2. Create namespace</span>
kubectl create namespace your-namespace

<span class="c"># 3. Create secrets</span>
./k8s/scripts/manage-secrets.sh create your-namespace <span class="s1">'your-api-key'</span>
./k8s/scripts/create-registry-secret.sh create

<span class="c"># 4. Deploy to your environment</span>
./k8s/scripts/deploy.sh deploy production

<span class="c"># 5. Verify deployment</span>
kubectl get pods <span class="nt">-n</span> your-namespace
kubectl get svc <span class="nt">-n</span> your-namespace
kubectl get ingressroute <span class="nt">-n</span> your-namespace

<span class="c"># 6. Check logs</span>
kubectl logs <span class="nt">-l</span> <span class="nv">app</span><span class="o">=</span>prisma-airs-mcp <span class="nt">-n</span> your-namespace
</code></pre></div></div>

<h3 id="post-deployment-verification">Post-Deployment Verification</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Health check</span>
curl https://your-domain.com/your-path/health

<span class="c"># Test MCP endpoint</span>
curl <span class="nt">-X</span> POST https://your-domain.com/your-path <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{"jsonrpc":"2.0","method":"ping","id":1}'</span>
</code></pre></div></div>

<h2 id="environment-specific-examples">Environment-Specific Examples</h2>

<h3 id="development-environment">Development Environment</h3>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># k8s/overlays/development/kustomization.yaml</span>
<span class="na">configMapGenerator</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">prisma-airs-mcp-config</span>
  <span class="na">behavior</span><span class="pi">:</span> <span class="s">merge</span>
  <span class="na">literals</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">airs.api.url=https://dev.aisecurity.example.com</span>  <span class="c1"># Dev API endpoint</span>
  <span class="pi">-</span> <span class="s">cache.ttl.seconds=60</span>
  <span class="pi">-</span> <span class="s">rate.limit.max.requests=200</span>
  <span class="pi">-</span> <span class="s">airs.default.profile.name=Development Profile</span>
</code></pre></div></div>

<h3 id="production-environment">Production Environment</h3>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># k8s/overlays/production/kustomization.yaml</span>
<span class="na">configMapGenerator</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">prisma-airs-mcp-config</span>
  <span class="na">behavior</span><span class="pi">:</span> <span class="s">merge</span>
  <span class="na">literals</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">airs.api.url=https://service.api.aisecurity.paloaltonetworks.com</span>
  <span class="pi">-</span> <span class="s">cache.ttl.seconds=300</span>
  <span class="pi">-</span> <span class="s">rate.limit.max.requests=100</span>
  <span class="pi">-</span> <span class="s">airs.default.profile.name=Production Security Profile</span>

<span class="na">secretGenerator</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">prisma-airs-mcp-secrets</span>
  <span class="na">behavior</span><span class="pi">:</span> <span class="s">replace</span>
  <span class="na">literals</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">airs.api.key=${AIRS_API_KEY}</span>  <span class="c1"># Use env var substitution</span>
</code></pre></div></div>

<h2 id="security-best-practices">Security Best Practices</h2>

<ol>
  <li><strong>Never commit real API keys</strong> - Use sealed secrets or external secret management</li>
  <li><strong>Use RBAC</strong> - Limit service account permissions</li>
  <li><strong>Network Policies</strong> - Restrict pod-to-pod communication</li>
  <li><strong>Pod Security</strong> - Run as non-root user (already configured)</li>
  <li><strong>Secret Rotation</strong> - Plan for API key rotation</li>
</ol>

<h2 id="troubleshooting">Troubleshooting</h2>

<h3 id="common-issues">Common Issues</h3>

<ol>
  <li><strong>API Key Issues</strong>:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check if secret exists</span>
kubectl get secret prisma-airs-mcp-secrets <span class="nt">-n</span> your-namespace
   
<span class="c"># Verify pod has correct env var</span>
kubectl <span class="nb">exec</span> <span class="nt">-it</span> &lt;pod-name&gt; <span class="nt">-n</span> your-namespace <span class="nt">--</span> <span class="nb">printenv </span>AIRS_API_KEY
</code></pre></div>    </div>
  </li>
  <li><strong>Profile Configuration</strong>:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check ConfigMap</span>
kubectl get configmap <span class="nt">-n</span> your-namespace
kubectl describe configmap &lt;configmap-name&gt; <span class="nt">-n</span> your-namespace
</code></pre></div>    </div>
  </li>
  <li><strong>Registry Access</strong>:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check pull secret</span>
kubectl get secret ghcr-login-secret <span class="nt">-n</span> your-namespace
   
<span class="c"># Check pod events for pull errors</span>
kubectl describe pod &lt;pod-name&gt; <span class="nt">-n</span> your-namespace
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="support">Support</h2>

<p>For deployment issues:</p>
<ol>
  <li>Check pod logs: <code class="language-plaintext highlighter-rouge">kubectl logs -f &lt;pod-name&gt; -n your-namespace</code></li>
  <li>Describe pod: <code class="language-plaintext highlighter-rouge">kubectl describe pod &lt;pod-name&gt; -n your-namespace</code></li>
  <li>Review events: <code class="language-plaintext highlighter-rouge">kubectl get events -n your-namespace --sort-by='.lastTimestamp'</code></li>
</ol>

</body>
</html>